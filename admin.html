<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .star {
      background-color: white;
      border-radius: 50%;
      position: absolute;
      animation: twinkling 2s infinite, move 10s infinite;
    }
    @keyframes twinkling {
      0% { opacity: 0.6; }
      50% { opacity: 1; }
      100% { opacity: 0.6; }
    }
    @keyframes move {
      0% { transform: translate(0, 0); }
      100% { transform: translate(30px, 30px); }
    }
  </style>
</head>
<body class="bg-black text-white min-h-screen px-6 py-4 relative">
  <div id="starfield" class="absolute inset-0 z-0 pointer-events-none overflow-hidden"></div>
  <div class="absolute inset-0 bg-gradient-to-br from-transparent to-[#1a1a1a] z-0"></div>

  <div class="w-28 h-28 mx-auto mt-6 mb-4 z-10 relative">
    <img src="holl.png" alt="">
  </div>
  <h1 class="text-4xl font-bold mb-6 text-center bg-gradient-to-r from-yellow-400 to-pink-500 text-transparent bg-clip-text z-10 relative">Admin Dashboard</h1>

  <div id="stats" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 z-10 relative"></div>
  <table class="w-full text-left border-collapse z-10 relative">
    <thead>
      <tr class="bg-white/10">
        <th class="p-3">Referral Code</th>
        <th class="p-3">Referrals</th>
      </tr>
    </thead>
    <tbody id="topReferrers"></tbody>
  </table>

  <script>
    const container = document.getElementById('starfield');
    for (let i = 0; i < 100; i++) {
      const star = document.createElement('div');
      const size = Math.random() * 2 + 1;
      star.className = 'star';
      star.style.width = `${size}px`;
      star.style.height = `${size}px`;
      star.style.top = `${Math.random() * 100}%`;
      star.style.left = `${Math.random() * 100}%`;
      star.style.animationDuration = `${1.5 + Math.random() * 2}s, ${15 + Math.random() * 10}s`;
      container.appendChild(star);
    }

    fetch('https://pure-sea-47438-9b41a08c5720.herokuapp.com/admin/dashboard', {
      headers: { 'Authorization': 'Bearer ' + localStorage.getItem('admin_token') }
    })
      .then(res => res.json())
      .then(data => {
        document.getElementById('stats').innerHTML = `
          <div class="bg-white/5 border border-white/10 rounded-xl p-6">
            <h2 class="text-xl font-semibold mb-2">Total Users</h2>
            <p class="text-3xl text-yellow-400 font-bold">${data.total_users}</p>
          </div>
          <div class="bg-white/5 border border-white/10 rounded-xl p-6">
            <h2 class="text-xl font-semibold mb-2">Total Coins</h2>
            <p class="text-3xl text-green-400 font-bold">${data.total_rave_coins}</p>
          </div>
          <div class="bg-white/5 border border-white/10 rounded-xl p-6">
            <h2 class="text-xl font-semibold mb-2">Top Referrer</h2>
            <p class="text-lg text-blue-400">${data.top_referrers[0]?.referred_by || 'N/A'}</p>
            <p class="text-sm text-gray-300">${data.top_referrers[0]?.count || 0} referrals</p>
          </div>`;

        const tbody = document.getElementById('topReferrers');
        data.top_referrers.forEach(ref => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td class="p-3">${ref.referred_by}</td>
            <td class="p-3">${ref.count}</td>`;
          tbody.appendChild(tr);
        });
      })
      .catch(err => console.error('Failed to load admin data', err));
  </script>
</body>
</html>